<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://unpkg.com/react@17.0.1/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17.0.1/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone@7.12.4/babel.js"></script>
    <script src="https://unpkg.com/prop-types@15.7.2/prop-types.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
      integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2"
      crossorigin="anonymous"
    />
    <title>Basics</title>
  </head>
  <body>
    <div id="root"></div>
  </body>
  <script type="text/babel">
    const gruss = new Date().getHours() < 12 ? 'Morgen' : 'Tag';

    function Message(props) {
      const className = `alert alert-${props.title.length > 5 ? 'danger' : 'success'}`;

      return (
        <div className={className}>
          {props.title && (
            <h4 className="alert-heading">
              {props.title} {props.subtitle && <small>{props.subtitle}</small>}
            </h4>
          )}

          {props.children}
        </div>
      );
    }

    Message.propTypes = {
      title: PropTypes.string.isRequired,
      subtitle: PropTypes.string,

      /* title(props, propName, componentName) {
        //console.log('juhu, prop type check', { props, propName, componentName });
        if (!props[propName]) {
          return new Error(`${componentName} requires ${propName} to be passed`);
        }
        if (typeof props[propName] !== 'string') {
          return new Error(`${componentName} has to be a string`);
        }
      }, */
    };

    function IBAN() {
      const inputRef = React.useRef();
      const [iban, setIban] = React.useState('');

      const onChange = () => {
        const iban =
          inputRef.current.value
            .toUpperCase()
            .replace(/\s/g, '')
            .replace(/[^0-9A-Z]/g, '')
            .match(/.{1,4}/g) || [];
        setIban(iban.join(' '));
      };

      return <input ref={inputRef} value={iban} onChange={onChange} className="form-control" />;
    }

    function Form() {
      const [isValid, setIsValid] = React.useState(null);

      const inputRef = React.useRef();
      const msgRef = React.useRef();

      const onChange = (event) => {
        const value = event.target.value;
        const isValid = value.length > 8 && /\d+/.test(value);
        setIsValid(isValid);
      };

      const onSubmit = (event) => {
        event.preventDefault();
        console.log('nachricht mit betreff', inputRef.current.value, 'und inhalt', msgRef.current.value);
      };

      const className = `
        form-control
        ${isValid === true && 'is-valid'}
        ${isValid === false && 'is-invalid'}
      `;

      return (
        <form>
          <label htmlFor="password">Passwort</label>
          <input type="text" className={className} id="password" autoComplete="off" onChange={onChange} />
          <div className="valid-feedback">Looks good!</div>
          <div className="invalid-feedback">Min. 5 Zeichen, min 1 Gro√ü-, 1 Kleinbuchstabe und eine Zahl</div>
          <button className="btn btn-primary mt-2" type="submit" disabled>
            Registrieren
          </button>
        </form>
      );
    }

    const element = (
      <div className="container mt-3">
        <Message title="moin moin">Guten {gruss}</Message>
        <Message title="Olla" subtitle="buenos dias">
          Guten Tag
        </Message>
        <Message title="salut">Guten Nacht</Message>

        <Form />

        <IBAN />
      </div>
    );

    ReactDOM.render(element, document.getElementById('root'));
  </script>
</html>
